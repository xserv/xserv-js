<!DOCTYPE html>
<html>
  <head>
    <title>HTML5 Demo</title>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="..//xserv.js"></script>
    <link rel="stylesheet" type="text/css" href="core.css">
  </head>
  
  <body>
    <div class="box">
      <span>Connection status</span>
      <span>
	<svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px">
	  <circle id="state" cx="10" cy="10" r="10" fill="red" />
	</svg>
      </span>
    </div>
    <pre id="output"></pre>
  </body>
  <script>
    $(document).ready(function() {
	
	var xserv = new Xserv('qLxFC-1'); // app_id
	// xserv.setReconnectInterval(20000);
	
	xserv.addEventListener('open', function() {
           $('#state').attr('fill', 'green');
           // xserv.historyById('test', 'all', 1);
	});
	
	xserv.addEventListener('close', function() {
	    $('#state').attr('fill', 'red');
	});
	
	xserv.addEventListener('events', function(event) {
            var html = "<div id='blah' class='row'>EVENTS " + JSON.stringify(event) + "</div>";
            $(html).hide().appendTo('#output').fadeIn(1000);
        });
        
        xserv.addEventListener('events:op', function(event_op) {
            var html = "<div id='blah' class='row'>OP " + JSON.stringify(event_op) + "</div>";
	    $(html).hide().appendTo('#output').fadeIn(1000);
	});
	
        xserv.bind('test', 'all');
        xserv.bind('test', 'all');
        xserv.bind('test', 'pippo');
        xserv.unbind('test', 'pippo');
        xserv.unbind('test2');
        xserv.historyById('test', 'all', 1, 5);
        // xserv.historyById('test', 'all', 1, 2000);
        xserv.historyById('test', 'pippo', 1); // default limit 100
        
        xserv.connect();
    });
  </script>
</html>
